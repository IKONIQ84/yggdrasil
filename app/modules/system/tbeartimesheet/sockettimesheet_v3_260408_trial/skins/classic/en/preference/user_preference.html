<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>{PAGE_TITLE}</title>
{__CSS_GLOBAL__}
<style type="text/css">@import url('{SKINROOT}/javascript/{BROWSER}/calendar/calendar-blue.css');</style>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar-en.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar-setup.js"></script>

<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/listing.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/helpScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/tabScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/functions.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/ajaxScript.js"></script>

<script>
// AJAX CORNER

function ajaxParser(){
	if(request.readyState == 1){
		document.getElementById('title').innerHTML = oriMessage + '&nbsp;&nbsp;&nbsp;<font id="executing"><img align="top" src="{SKINROOT}/images/executing.gif">Executing...</font>';
	}
	if(request.readyState == 4){ 
		var result = request.responseText.split('regexAJAX');
		document.getElementById('title').innerHTML = oriMessage;

		if(document.getElementById('action').value == 'delete_quicklinks' || document.getElementById('action').value == 'add_quicklinks') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('quicklinks_button').innerHTML = result[1];
			document.getElementById('menuAJAX').innerHTML = result[2];
		}
		if(document.getElementById('action').value == 'update') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'timesheet_display') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'update_password') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'off_days') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('off_days_listing').innerHTML = result[1];
		}
		if(document.getElementById('action').value == 'gethelp') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('helptitle').innerHTML = "Context Help";
			document.getElementById('helpdata').innerHTML = result[1];
			if(!document.getElementById('nohelp'))
				document.getElementById('helpdetected').value = 1;			
		}
		if(document.getElementById('action').value == 'getlog') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('logtitle').innerHTML = "Log Data";
			document.getElementById('logdata').innerHTML = result[1];
		}		
		if(document.getElementById('action').value == 'startpage') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('DefaultPage').innerHTML = result[1];
		}
		document.getElementById('action').value = '';
		enableButtons(document.forms[0]);
	}
	formParams = '';
}

function ajaxMain(formName,action){
	if(action == 'update') {
		if(!document.getElementById('listNumber').value || document.getElementById('listNumber').value < 1) {
			alert('Enter Value for Max Lines Per Page');
			return false;
		}
		if(!document.getElementById('truncateChar').value || document.getElementById('truncateChar').value < 1) {
			alert('Enter Value for Calendar Headline Truncate Characters');
			return false;
		}
	} 
	if(action == 'timesheet_display') {
		if(	
			document.getElementById('project_name').checked == false &&
			document.getElementById('project_code').checked == false &&
			document.getElementById('task_name').checked == false &&
			document.getElementById('task_code').checked == false
			)
			{
				alert("Select At Least One Display Setting");
				return false;
			}
	} 
	if(action == 'update_password') {
		if(!document.getElementById('old_password').value || 
			!document.getElementById('new_password').value ||
			!document.getElementById('confirm_password').value
			) {
				alert('Enter Required Value For Password');
				return false;
		}
		if(document.getElementById('new_password').value != document.getElementById('confirm_password').value) {
			alert('Password Not Synchronized');
			return false;
		}
		if(document.getElementById('old_password').value == document.getElementById('new_password').value) {
			alert('Same as Old Password');
			return false;
		}
	} 
	document.getElementById('action').value = action;
	getFormFields(formName);
	if(formParams == '') {
		for (i=0; i<formName.elements.length; i++) {
			if(formName.elements[i].id) {
				if(formName.elements[i].type == 'checkbox' || formName.elements[i].type == 'radio') {
					 if(formName.elements[i].checked) {
						formParams = formParams + "&" + formName.elements[i].id + "=" + encodeURIComponent(formName.elements[i].value);
					}	
				}
				else {
					formParams = formParams + "&" + formName.elements[i].id + "=" + encodeURIComponent(formName.elements[i].value);
				}	
			}	
			else if(formName.elements[i].name) {
				if(formName.elements[i].type == 'checkbox' || formName.elements[i].type == 'radio') {
					 if(formName.elements[i].checked) {
						formParams = formParams + "&" + formName.elements[i].name + "=" + encodeURIComponent(formName.elements[i].value);
					}	
				}
				else {	
					formParams = formParams + "&" + formName.elements[i].name + "=" + encodeURIComponent(formName.elements[i].value);
				}	
			}	
		}
	}

	request.open('POST', '{AJAX_FORM_POST}', true); //THIS ONE FOR POST
	request.onreadystatechange = ajaxParser;
	request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); //THIS ONE ADDED FOR POST ONLY
	request.send(formParams); //THIS ONE FOR POST
}
// AJAX CORNER

function passwordSelected(checkbox) {
	var oriColor = document.getElementById('First Name').style.color;
	if(checkbox.checked) {
		document.getElementById('password_required').style.color='red';
		document.getElementById('confirm_password_required').style.color='red';
		focus(document.getElementById('password').name);
	}
	else {
		document.getElementById('password_required').style.color=oriColor;
		document.getElementById('confirm_password_required').style.color=oriColor;
	}
}
</script>
</head>

<body onload="showTab();">
<table width="100%" cellpadding="0" cellspacing="2">
	<tr>
		<td><img src="{SKINROOT}/images/logo.gif" /></td>
		<td height="100%" valign="bottom">
			<table align="right" height="100%" cellspacing="5" cellpadding="0">
			<tr>
				<td class="td_top">Logged In: {FULL_NAME} |</td>
				<td class="td_top">{ADMIN_USER_LINK}</td>
				<td class="td_top">{LOGOUT_LINK}</td>
			</tr></table>
		</td>
	</tr>
	<tr><td class="spacer" colspan="2"></td></tr>
</table>
	
<div class="div_top_menu">
	{DIV_TOP_MENU}
</div>
	
<div class="div_top_menu_foot"></div>
<div id='submenu' class="div_sub_menu" align="right">Clock & Date Container</div>
<script>startclock();</script>

<table width="100%" height="100%"><tr><td nowrap valign="top">
	<table width="100%" height="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td class="menu_table_parent">
		<table class="menu_table_container">
		<tr><td>
			{SIDE_MENU}
		</td></tr>
		<tr><td>
			<div id="menuAJAX" name="menuAJAX">
				{QUICKLINKS_MENU}
			</div>
		</td></tr>
		</table>
		</td>
		<td class="main_table">
		<table width="100%" class="module_page_table">
			<tr><td>
				<H1 id='title' name='title'>{H1_TITLE}</H1>
				<div id="div_breadcrumbs" name="div_breadcrumbs">{BREADCRUMBS}</div>
				<div id="{MESSAGE_ID}" name="{MESSAGE_ID}" {MESSAGE_BOX}>{MESSAGE}</div>
			</td></tr>
			<tr><td height="10"></td></tr>
			<tr><td nowrap>
				<ul id="tablist" style="display:none">
					<li><span class="current" onmouseover="overtab('sc1',this)" onmouseout="outtab('sc1',this)" onclick="return expandcontent('sc1', this)"><img title='tabimage' src="{SKINROOT}/images/general.gif" align="absmiddle" />&nbsp;General Preference</span></li>
					<li><span onmouseover="overtab('sc2',this)" onmouseout="outtab('sc2',this)" onclick="return expandcontent('sc2', this)"><img title='tabimage' src="{SKINROOT}/images/timesheet.gif" align="absmiddle" />&nbsp;Timesheet Display</span></li>
					<li><span onmouseover="overtab('sc3',this)" onmouseout="outtab('sc3',this)" onclick="return expandcontent('sc3', this)"><img title='tabimage' src="{SKINROOT}/images/offday.gif" align="absmiddle" />&nbsp;Off Days</span></li>
					<li><span name='change_password' id='change_password' onmouseover="overtab('sc4',this)" onmouseout="outtab('sc4',this)" onclick="return expandcontent('sc4', this)"><img title='tabimage' src="{SKINROOT}/images/password.gif" align="absmiddle" />&nbsp;Password</span></li>
					<li><span onmouseover="overtab('logsection',this)" onmouseout="outtab('logsection',this)" onclick="getLog();return expandcontent('logsection', this)"><img title='tabimage' src="{SKINROOT}/images/log.gif" align="absmiddle" />&nbsp;Log</span></li>
					<li><span onmouseover="overtab('helpsection',this)" onmouseout="outtab('helpsection',this)" onclick="getHelp();return expandcontent('helpsection', this)"><img title='tabimage' src="{SKINROOT}/images/help.gif" align="absmiddle" />&nbsp;Help</span></li>
				</ul>
	
				<DIV id="tabcontentcontainer">
					<form name='addupdate' id='addupdate' {FORM_ACTION} method="post" onsubmit="submitonce(this)">
					<input name="addupdateID" id="addupdateID" type="hidden" value="{ID}" />
					<input name="update_title" id="update_title" type="hidden" value="{UPDATE_TITLE}" />
					<input name="action" id="action" type="hidden" />
					<input name="submit_action" id="submit_action" type="hidden" value="{SUBMIT_ACTION}" />
					<input name="messageID" id="messageID" value="{MESSAGE_ID}" type="hidden" />
					<input name="quickLinksName" id="quickLinksName" type="hidden" value="{QUICKLINKS_NAME}"/>
					<input name="quickLinksURL" id="quickLinksURL" type="hidden" value="{QUICKLINKS_URL}"/>
					<input name="quickLinksDesc" id="quickLinksDesc" type="hidden" value="{QUICKLINKS_DESC}"/>
					<input name="helpdetected" id="helpdetected" type="hidden"/>
					<input name="LogType" id="LogType" type="hidden" value="{LOGTYPE}"/>
					<input name="LogAction" id="LogAction" type="hidden" value="{LOGACTION}"/>
					<input name="startup_page" id="startup_page" type="hidden" value="{STARTUP_PAGE}"/>
					<div id="sc1" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/general.gif" align="absmiddle" />&nbsp;<span id='subtitle'>{H1_TITLE}</span></legend>
							<div id="listingOutputAJAX">
								<table nowrap cellspacing="0" cellpadding="3">
									<th colspan=3>Details</th>
									<tr><td colspan=2>Date Format:</td><td align="right">
										<select class="textbox" id="date_format" name="date_format">
											<option value="d-m-Y" {OPTION_DD-MM-YYYY}>DD-MM-YYYY</option>
											<option value="m-d-Y" {OPTION_MM-DD-YYYY}>MM-DD-YYYY</option>
											<option value="Y-m-d" {OPTION_YYYY-MM-DD}>YYYY-MM-DD</option>
											<option value="Y-d-m" {OPTION_YYYY-DD-MM}>YYYY-DD-MM</option>
											<option value="d-F-Y" {OPTION_DD-MONTH-YYYY}>DD-MONTH-YYYY</option>
											<option value="F-d-Y" {OPTION_MONTH-DD-YYYY}>MONTH-DD-YYYY</option>
											<option value="d-M-Y" {OPTION_DD-MON-YYYY}>DD-MON-YYYY</option>
											<option value="M-d-Y" {OPTION_MON-DD-YYYY}>MON-DD-YYYY</option>
										</select>
									</td></tr>
									<tr><td colspan=2>Name Format:</td><td align="right">
										<select class="textbox" id="name_format" name="name_format">
											{DROPDOWN_NAME}
										</select>
									</td></tr>
									<tr>
										<td colspan=2>Currency Preference:</td><td align="right">
											<select class="textbox" id="currency_pref" name="currency_pref">
												{DROPDOWN_CURRENCY}
											</select>
										</td>
									</tr>
									<tr>
										<td id="field_required">List Max Lines Per Page:</td>
										<td colspan="2" align="right"><input value='{MAX_LINES}' onkeypress="return keyPress(event,'integer');" maxlength="3" size="3" class="textbox" id="listNumber" name="listNumber" type="text" ></td>
									</tr>
									<tr>
										<td id="field_required">Calendar Headline Truncate Characters:</td>
										<td colspan="2" align="right"><input value='{TRUNCATE_CALENDAR}' onkeypress="return keyPress(event,'integer');" maxlength="3" size="3" class="textbox" id="truncateChar" name="truncateChar" type="text" ></td>
									</tr>
									<tr>
										<td colspan=2>Default Thousand Separator (<strong>SPC</strong> For Space):</td>
										<td align="right"><input value='{THOUSAND_SEPARATOR}' maxlength="3" size="3" class="textbox" id="thousand_separator" name="thousand_separator" type="text" onkeypress="return keyPress(event,'normaltext');"></td>
									</tr>
									<tr>
										<td colspan=2>Default Decimal Separator (<strong>SPC</strong> For Space):</td>
										<td align="right"><input value='{DECIMAL_SEPARATOR}' maxlength="3" size="3" class="textbox" id="decimal_separator" name="decimal_separator" type="text" onkeypress="return keyPress(event,'normaltext');"></td>
									</tr>
									<tr>
										<td>Task Wrapping:</td>
										<td colspan="2" align="right"><input id="task_wrap" name="task_wrap" type="radio" value="1" {TASK_AUTO_WRAP}>Auto Wrap <input id="task_wrap" name="task_wrap" type="radio" value="0" {TASK_NO_WRAP}>No Wrap</td>
									</tr>
									<tr>
										<td>Show Only Open Tasks In Open Projects List?:</td>
										<td colspan="2" align="right"><input id="open_task" name="open_task" type="radio" value="1" {OPEN_TASK_YES}>Yes <input id="open_task" name="open_task" type="radio" value="0" {OPEN_TASK_NO}>No</td>
									</tr>
									<tr>
										<td>Expand All Project Tasks By Default?:</td>
										<td colspan="2" align="right"><input id="task_show" name="task_show" type="radio" value="1" {TASK_SHOW}>Yes <input id="task_show" name="task_show" type="radio" value="0" {TASK_HIDE}>No</td>
									</tr>
								</table>						
							</div>
							<div id="listingButtonsAJAX">{SHOW_BUTTONS}</div>
						</fieldset>
					</div>
					<div id="sc2" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/timesheet.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Timesheet Tasks Display</span></legend>
						<div>		
							<table nowrap cellspacing="0" cellpadding="3">
								  <th colspan="2">Display Project and Task Code</th>
								  <tr style="display:none">
										<td><input id="project_name" name="project_name" type="checkbox" value="1" {CHECK_PROJECT_NAME}></td>
										<td>Project Name</td>
								  </tr>
								  <tr>
										<td><input id="project_code" name="project_code" type="checkbox" value="1" {CHECK_PROJECT_CODE}></td>
										<td>Project Code</td>
								  </tr>
								  <tr class="tr" style="display:none">
										<td><input id="task_name" name="task_name" type="checkbox" value="1" {CHECK_TASK_NAME}></td>
										<td>Task Name</td>
								  </tr>
								  <tr>
										<td><input id="task_code" name="task_code" type="checkbox" value="1" {CHECK_TASK_CODE}></td>
										<td>Task Code</td>
								  </tr>
							</table> 
						</div>
						<div>
							<input onclick="ajaxMain(document.forms[0],'timesheet_display');" id="timesheetDisplay" name="timesheetDisplay" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Update Display">					
						</div>					
						</fieldset>
					</div>
					<div id="sc3" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/offday.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Current Off Days Selection / Off Days Configuration</span></legend>								  
						<div>
						  <table cellspacing="0" cellpadding="3" class="no-border">
							  <tr>
								  <td valign="top">
										<div id="off_days_listing">
											<table cellpadding="3" cellspacing=0 nowrap>
												{LISTING_OUTPUT}
											</table>
										</div>
								  </td>
								  <td valign="top">
									  <table cellspacing="0" cellpadding="3">
										  <th colspan=2>Off Days Configuration</th>	
										  <tr>
											<td><input id="day_off_sunday" name="day_off_sunday" type="checkbox" value="0:" {CHECK_SUNDAY}></td>
											<td>Sunday</td>
										  </tr>
										  <tr>
											<td><input id="day_off_monday" name="day_off_monday" type="checkbox" value="1:" {CHECK_MONDAY}></td>
											<td>Monday</td>
										  </tr>
										  <tr>
											<td><input id="day_off_tuesday" name="day_off_tuesday" type="checkbox" value="2:" {CHECK_TUESDAY}></td>
											<td>Tuesday</td>
										  </tr>
										  <tr>
											<td><input id="day_off_wednesday" name="day_off_wednesday" type="checkbox" value="3:" {CHECK_WEDNESDAY}></td>
											<td>Wednesday</td>
										  </tr>
										  <tr>
											<td><input id="day_off_thursday" name="day_off_thursday" type="checkbox" value="4:" {CHECK_THURSDAY}></td>
											<td>Thursday</td>
										  </tr>
										  <tr>
											<td><input id="day_off_friday" name="day_off_friday" type="checkbox" value="5:" {CHECK_FRIDAY}></td>
											<td>Friday</td>
										  </tr>
										  <tr>
											<td><input id="day_off_saturday" name="day_off_saturday" type="checkbox" value="6:" {CHECK_SATURDAY}></td>
											<td>Saturday</td>
										  </tr>
										  <tr>
												<td colspan=2><strong>Effective Start Date:</strong></td>
										  </tr>
										  <tr>
												<td colspan=2><input class="textbox" id="start_weekend" name="start_weekend" type="text" size="11" value='{EFFECTIVE_DATE}' readonly>&nbsp;<img id="effective_date" align="absmiddle" src="{SKINROOT}/images/calendar.gif"></td>
										  </tr>
									  </table>
										<BR>
										<div>
											<input onclick="ajaxMain(document.forms[0],'off_days');" id="offDays" name="offDays" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Update Off Days">					
										</div>					
								  </td>
							  </tr>
						  </table>
						</div>
						</fieldset>
					</div>
					<div id="sc4" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/password.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Change Password</span></legend>
						<div>
							<table nowrap cellspacing="0" cellpadding="3">
								<tr><th colspan=3>Change Current Password</th></tr>
								<tr>
								  <td id="field_required">Old Password:</td><td></td>
								  <td><input class="textbox" id="old_password" name="old_password" type="password" size="20" maxlength="30" onKeyPress="return keyPress(event,'normaltext')"></td>
								</tr>
								<tr>
								  <td id="field_required">New Password:</td><td></td>
								  <td><input class="textbox" id="new_password" name="new_password" type="password" size="20" maxlength="30" onKeyPress="return keyPress(event,'normaltext')"></td>
								</tr>
								<tr>
								  <td id="field_required">Confirm Password:</td><td></td>
								  <td><input class="textbox" id="confirm_password" name="confirm_password" type="password" size="20" maxlength="30" onKeyPress="return keyPress(event,'normaltext')"></td>
								</tr>
							</table>
						</div>
						<div>
								<input onclick="ajaxMain(document.forms[0],'update_password');" id="update_password" name="update_password" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Update Password">					
						</div>
						</fieldset>
					</div>
					<div id="logsection" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/log.gif" align="absmiddle" /><span id='logtitle'>No Log Data In Session</span></legend>											
						<div id="logdata">
							<BR />
							<input onclick='getLog()' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Refresh Log Data">
						</div>
						</fieldset>	
					</div>
					<div id="helpsection" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/help.gif" align="absmiddle" /><span id='helptitle'>No Context Help Data In Session</span></legend>											
						<div id="helpdata">
							<BR />
							<input onclick='getHelp()' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Refresh Context Help">
						</div>
						</fieldset>	
					</div>
					</form>
				</DIV>		
			</td></tr>
		</table>
		{SHOW_FOOTER}
		</td> 
	</tr>
	</table>
</td></tr></table>

<script>var oriMessage = document.getElementById('title').innerHTML;</script>
<script>
//MAKE PASSWORD REQUIRED FOR ADD USERS
if(!document.getElementById('addupdateID').value) {
	document.getElementById('password_required').style.color='red';
	document.getElementById('confirm_password_required').style.color='red';
}
</script>
<script type="text/javascript">
	Calendar.setup(
		{
			inputField 	: 	"start_weekend",
			ifFormat	:	"{DATE_FORMAT}",
			button		:	"effective_date"	
		}
	);
</script>
{CHANGE_PASSWORD_SCRIPT}
</body>
</html>
