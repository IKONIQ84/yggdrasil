<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>{PAGE_TITLE}</title>
{__CSS_GLOBAL__}
<style type="text/css">@import url('{SKINROOT}/javascript/{BROWSER}/calendar/calendar-blue.css');</style>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar-en.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar-setup.js"></script>

<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/fieldSelection.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/reportScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/helpScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/tabScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/functions.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/ajaxScript.js"></script>

<script>
// AJAX CORNER

function ajaxParser(){
	if(request.readyState == 1){
		document.getElementById('title').innerHTML = oriMessage + '&nbsp;&nbsp;&nbsp;<font id="executing"><img align="top" src="{SKINROOT}/images/executing.gif">Executing...</font>';
	}
	if(request.readyState == 4){ 
		var result = request.responseText.split('regexAJAX');
		document.getElementById('title').innerHTML = oriMessage;

		if(document.getElementById('action').value == 'delete_quicklinks' || document.getElementById('action').value == 'add_quicklinks') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('quicklinks_button').innerHTML = result[1];
			document.getElementById('menuAJAX').innerHTML = result[2];
		}
		if(document.getElementById('action').value == 'generate') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('reportResult').innerHTML = result[1];
			document.getElementById('reportOutput').style.display='';
			if(parseInt(result[2])==1) { //No Record
				document.getElementById('exportResult').style.display='none';
				document.getElementById('emailResult').style.display='none';				
			}	
			else { //Got Record
				document.getElementById('exportResult').style.display='';
				document.getElementById('emailResult').style.display='';
			}	
			expandcontent('sc2', document.getElementById('reportOutput'));
		}
		if(document.getElementById('action').value == 'sort_table') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('reportResult').innerHTML = result[1];
		}
		if(document.getElementById('action').value == 'save_report') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			if(parseInt(result[1]))
				document.getElementById('savedReportID').value = result[1];			
			else
				alert('Cannot Detect DB Insert ID');
				
			document.getElementById('report_unsaved_buttons').style.display = 'none';			
			document.getElementById('report_saved_buttons').style.display = '';			
		}
		if(document.getElementById('action').value == 'share_report') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			if(parseInt(result[1]))
				document.getElementById('sharedReportID').value = result[1];			
			else
				alert('Cannot Detect DB Insert ID');
				
			document.getElementById('report_unshared_buttons').style.display = 'none';			
			document.getElementById('report_shared_buttons').style.display = '';			
		}
		if(document.getElementById('action').value == 'update_saved_report') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'update_shared_report') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'export_report') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'email_report') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
		}
		if(document.getElementById('action').value == 'gethelp') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('helptitle').innerHTML = "Context Help";
			document.getElementById('helpdata').innerHTML = result[1];
			if(!document.getElementById('nohelp'))
				document.getElementById('helpdetected').value = 1;			
		}
		if(document.getElementById('action').value == 'getlog') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('logtitle').innerHTML = "Log Data";
			document.getElementById('logdata').innerHTML = result[1];
		}		
		if(document.getElementById('action').value == 'startpage') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('DefaultPage').innerHTML = result[1];
		}
		document.getElementById('action').value = '';
		enableButtons(document.forms[0]);
		submitMultiUnSelect(document.getElementById('source'),document.getElementById('target'));
	}
	formParams = '';
}

function ajaxMain(formName,action){
	filterMap();
	queryAJAX(document.getElementById("tableSearch"),0);
	
	document.getElementById('TaskIDs').value = '';
	document.getElementById('action').value = action;
	
	if(action == 'export_report') {
		if(!document.getElementById('exportTitle').value) {
			alert('Enter Title For Report');
			document.getElementById('exportTitle').focus();
			return false;
		}
		if(!document.getElementById('printer').checked) {
			if(!document.getElementById('exportFilename').value) {
				alert('Enter Filename For Export');
				document.getElementById('exportFilename').focus();
				return false;
			}
		}
	}
	if(action == 'email_report') {
		if(!document.getElementById('sender_name').value) {
			alert('Enter Email Originator\'s Name');
			document.getElementById('sender_name').focus();
			return false;
		}
		if(!document.getElementById('sender_email').value) {
			alert('Enter Originator\'s Email Address');
			document.getElementById('sender_email').focus();
			return false;
		}
		if(!document.getElementById('email_subject').value) {
			alert('Enter Email Subject');
			document.getElementById('email_subject').focus();
			return false;
		}
		if(!document.getElementById('email_content').value) {
			alert('Enter Email Content');
			document.getElementById('email_content').focus();
			return false;
		}
		for (i=0;i<document.getElementById('email_target').length;i++)  {
			document.getElementById('email_target').options[i].selected = true;
		}	
		if(!verifySelect('email_target')) {
			alert('Please Select At Least One User To Email Report To');
			return false;
		}
		populateEmailFields(document.getElementById('email_source'),document.getElementById('email_target'));
	}
	if(action == 'generate') {
		if(!verifyReport())
			return false;
	}
	if(action == 'save_report' || action == 'update_saved_report') {
		if(!document.getElementById('save_report_name').value) {
			alert('Enter Report Name To Save Report');
			document.getElementById('save_report_name').focus();
			return false;
		}
		saveShareFunctions();		
	}
	if(action == 'share_report' || action == 'update_shared_report') {
		if(!document.getElementById('share_report_name').value) {
			alert('Enter Report Name To Share Report');
			document.getElementById('share_report_name').focus();
			return false;
		}	
		for (i=0;i<document.getElementById('share_user_target').length;i++)  {
			document.getElementById('share_user_target').options[i].selected = true;
		}	
		if(!verifySelect('share_user_target')) {
			alert('Please Select At Least One User To Share Report');
			return false;
		}
		populateSharedFields(document.getElementById('share_user_source'),document.getElementById('share_user_target'));
		saveShareFunctions();
	}
	getFormFields(formName);
	if(formParams == '') {
		for (i=0; i<formName.elements.length; i++) {
			if(formName.elements[i].id) {
				if(formName.elements[i].type == 'checkbox' || formName.elements[i].type == 'radio') {
					 if(formName.elements[i].checked) {
						formParams = formParams + "&" + formName.elements[i].id + "=" + encodeURIComponent(formName.elements[i].value);
					}	
				}
				else {
					formParams = formParams + "&" + formName.elements[i].id + "=" + encodeURIComponent(formName.elements[i].value);
				}	
			}	
			else if(formName.elements[i].name) {
				if(formName.elements[i].type == 'checkbox' || formName.elements[i].type == 'radio') {
					 if(formName.elements[i].checked) {
						formParams = formParams + "&" + formName.elements[i].name + "=" + encodeURIComponent(formName.elements[i].value);
					}	
				}
				else {	
					formParams = formParams + "&" + formName.elements[i].name + "=" + encodeURIComponent(formName.elements[i].value);
				}	
			}	
		}
	}

	request.open('POST', '{AJAX_FORM_POST}', true); //THIS ONE FOR POST
	request.onreadystatechange = ajaxParser;
	request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); //THIS ONE ADDED FOR POST ONLY
	request.send(formParams); //THIS ONE FOR POST
}
// AJAX CORNER
</script>
<script>
//REPORT BASED SCRIPTING...CONSIDER SHARING
function saveShareFunctions() {
	for (i=0;i<document.getElementById('prjselect').length;i++)  {
		if(document.getElementById('prjselect').options[i].selected) {
			document.getElementById('TaskIDs').value += document.getElementById('prjselect').options[i].id + ':';	
		}	
	}		
	submitMultiSelect(document.getElementById('source'),document.getElementById('target'),1);
}
function verifyReport() {
	if(!verifySelect('prjselect')) {
		alert('Please Select At Least One Task');
		return false;
	}
	else {
		for (i=0;i<document.getElementById('prjselect').length;i++)  {
			if(document.getElementById('prjselect').options[i].selected) {
				document.getElementById('TaskIDs').value += document.getElementById('prjselect').options[i].id + ':';	
			}	
		}
	}
	if(document.getElementById('date_manualrange').checked) {
		if(!document.getElementById('start_date').value || !document.getElementById('end_date').value) {
			alert('Enter Value For Manual Date Range');
			return false;
		}
		if(!checkStartEndDate('start_date','end_date'))
			return false;
	}
	if(!queryAJAX(document.getElementById("tableSearch"),1)) {
		return false;
	}	
	
    for (i=0;i<document.getElementById('target').length;i++)  {
		document.getElementById('target').options[i].selected = true;
    }	
	if(!verifySelect('target')) {
		alert('Please Select At Least One Field');
		return false;
	}
	else {
		submitMultiSelect(document.getElementById('source'),document.getElementById('target'),1);
	}
	return true;
}
</script>
</head>

<body onload="showTab();">
<table width="100%" cellpadding="0" cellspacing="2">
	<tr>
		<td><img src="{SKINROOT}/images/logo.gif" /></td>
		<td height="100%" valign="bottom">
			<table align="right" height="100%" cellspacing="5" cellpadding="0">
			<tr>
				<td class="td_top">Logged In: {FULL_NAME} |</td>
				<td class="td_top">{ADMIN_USER_LINK}</td>
				<td class="td_top">{LOGOUT_LINK}</td>
			</tr></table>
		</td>
	</tr>
	<tr><td class="spacer" colspan="2"></td></tr>
</table>
	
<div class="div_top_menu">
	{DIV_TOP_MENU}
</div>
	
<div class="div_top_menu_foot"></div>
<div id='submenu' class="div_sub_menu" align="right">Clock & Date Container</div>
<script>startclock();</script>

<table width="100%" height="100%"><tr><td nowrap valign="top">
	<table width="100%" height="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td class="menu_table_parent">
		<table class="menu_table_container">
		<tr><td>
			{SIDE_MENU}
		</td></tr>
		<tr><td>
			<div id="menuAJAX" name="menuAJAX">
				{QUICKLINKS_MENU}
			</div>
		</td></tr>
		</table>
		</td>
		<td class="main_table">
		<table width="100%" class="module_page_table">
			<tr><td>
				<H1 id='title' name='title'>{H1_TITLE}</H1>
				<div id="div_breadcrumbs" name="div_breadcrumbs">{BREADCRUMBS}</div>
				<div id="{MESSAGE_ID}" name="{MESSAGE_ID}" {MESSAGE_BOX}>{MESSAGE}</div>
			</td></tr>
			<tr><td height="10"></td></tr>
			<tr><td nowrap>
				<ul id="tablist" style="display:none">
					<li><span class="current" onmouseover="overtab('sc1',this)" onmouseout="outtab('sc1',this)" onclick="return expandcontent('sc1', this)"><img title='tabimage' src="{SKINROOT}/images/report_config.gif" align="absmiddle" />&nbsp;Configuration</span></li>
					<li><span id='reportOutput' name='reportOutput' style="display:none" onmouseover="overtab('sc2',this)" onmouseout="outtab('sc2',this)" onclick="return expandcontent('sc2', this)"><img title='tabimage' src="{SKINROOT}/images/report_result.gif" align="absmiddle" />&nbsp;Result</span></li>
					<li><span id='exportResult' name='exportResult' style="display:none" onmouseover="overtab('sc4',this)" onmouseout="outtab('sc4',this)" onclick="return expandcontent('sc4', this)"><img title='tabimage' src="{SKINROOT}/images/export.gif" align="absmiddle" />&nbsp;Export</span></li>
					<li><span id='emailResult' name='emailResult' style="display:none" onmouseover="overtab('sc5',this)" onmouseout="outtab('sc5',this)" onclick="return expandcontent('sc5', this)"><img title='tabimage' src="{SKINROOT}/images/email_write.gif" align="absmiddle" />&nbsp;Email</span></li>
					<li><span onmouseover="overtab('sc3',this)" onmouseout="outtab('sc3',this)" onclick="return expandcontent('sc3', this)"><img title='tabimage' src="{SKINROOT}/images/report_option.gif" align="absmiddle" />&nbsp;Options</span></li>
					<li><span onmouseover="overtab('logsection',this)" onmouseout="outtab('logsection',this)" onclick="getLog();return expandcontent('logsection', this)"><img title='tabimage' src="{SKINROOT}/images/log.gif" align="absmiddle" />&nbsp;Log</span></li>
					<li><span onmouseover="overtab('helpsection',this)" onmouseout="outtab('helpsection',this)" onclick="getHelp();return expandcontent('helpsection', this)"><img title='tabimage' src="{SKINROOT}/images/help.gif" align="absmiddle" />&nbsp;Help</span></li>
				</ul>
	
				<DIV id="tabcontentcontainer">
					<form name='addupdate' id='addupdate' {FORM_ACTION} method="post" onsubmit="submitonce(this)">
					<input name="addupdateID" id="addupdateID" type="hidden" value="{ID}" />
					<input name="update_title" id="update_title" type="hidden" value="{UPDATE_TITLE}" />
					<input name="action" id="action" type="hidden" />
					<input name="submit_action" id="submit_action" type="hidden" value="{SUBMIT_ACTION}" />
					<input name="messageID" id="messageID" value="{MESSAGE_ID}" type="hidden" />
					<input name="quickLinksName" id="quickLinksName" type="hidden" value="{QUICKLINKS_NAME}"/>
					<input name="quickLinksURL" id="quickLinksURL" type="hidden" value="{QUICKLINKS_URL}"/>
					<input name="quickLinksDesc" id="quickLinksDesc" type="hidden" value="{QUICKLINKS_DESC}"/>
					<input name="helpdetected" id="helpdetected" type="hidden"/>
					<input name="LogType" id="LogType" type="hidden" value="{LOGTYPE}"/>
					<input name="LogAction" id="LogAction" type="hidden" value="{LOGACTION}"/>
					<input name="startup_page" id="startup_page" type="hidden" value="{STARTUP_PAGE}"/>
					
					<!-- REPORT SPECIFIC FIELDS -->
					<input name="TaskIDs" id="TaskIDs" type="hidden"/>
					<input name="field" id="field" type="hidden" value="{POST_FIELD}" />
					<input name="sortType" id="sortType" type="hidden" value="{POST_SORTTYPE}" />
					<input name="reportURL" id="reportURL" type="hidden" value="{REPORT_URL}"/>
					<input name="savedReportID" id="savedReportID" type="hidden" value="{SAVED_REPORT_ID}"/>
					<input name="sharedReportID" id="sharedReportID" type="hidden" value="{SHARED_REPORT_ID}"/>
					
					<div id="sc1" class="tabcontent">
						<fieldset>
							<table cellpadding="10" cellspacing="0">
							<tr valign="top">
								<td nowrap>
									<div><img src="{SKINROOT}/images/report_config.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Available Tasks</span></div>
									<div id="listingProjectAJAX" style="margin-left:20">{LIST_TASKS}</div>
									<div id="manualAllRadioAJAX" style="margin-left:20">
										<input id='prjallselect' onClick="selectAll('prjselect');" name="prjlist" type="radio" value="all" {SELECT_ALL}>Select All&nbsp;
										<input id='prjallunselect' onClick="unSelectAll('prjselect');" name="prjlist" type="radio" value="all" {UN_SELECT_ALL}>UnSelect All&nbsp;
										<input id='prjmanualselect' name="prjlist" type="radio" value="manual" {SELECT_MANUAL}>Manual&nbsp;
									</div>
								</td>
								<td nowrap>
									<div><img src="{SKINROOT}/images/calendar.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Calculations For</span></div>
									<div id="manualAllDateJAX">
									<div id="dateStatusAJAX" style="margin-left:20">
										<input onclick="document.getElementById('showdaterange').style.display='none'" id="date_thisweek" name="daterange" type="radio" value="thisweek" {THIS_WEEK_RANGE}>This Week<BR />
										<input onclick="document.getElementById('showdaterange').style.display='none'" id="date_thismonth" name="daterange" type="radio" value="thismonth" {THIS_MONTH_RANGE}>This Month<BR />
										<input onclick="document.getElementById('showdaterange').style.display='none'" id="date_thisyear" name="daterange" type="radio" value="thisyear" {THIS_YEAR_RANGE}>This Year<BR />
										<input onclick="document.getElementById('showdaterange').style.display='none'" id="date_entirerange" name="daterange" type="radio" value="allrange" {ENTIRE_RANGE}>Entire Range<BR />
										<input onclick="document.getElementById('showdaterange').style.display=''" id="date_manualrange" name="daterange" type="radio" value="manualrange" {MANUAL_RANGE}>Selected Range<BR />
										<div id="showdaterange" {DATE_RANGE_STYLE}>
											<table class="no-border" style="margin-left:30">
												<tr><td>Start Date:</td><td><input value="{RANGE_START_DATE}" class="textbox" id="start_date" name="start_date" type="text" size="12" readonly="true"></td><td><img align="absmiddle" id="start_date_icon" src="{SKINROOT}/images/calendar.gif"></td></tr>
												<tr><td>End Date:</td><td><input value="{RANGE_END_DATE}" class="textbox" id="end_date" name="end_date" type="text" size="12" readonly="true"></td><td><img align="absmiddle" id="end_date_icon" src="{SKINROOT}/images/calendar.gif"></td></tr>
											</table>											
										</div>
									</div>									
									</div>
								</td>
							</tr>
							<tr valign="top">
								<td nowrap colspan=2>
									<div id="listingProjectAJAX"><input onclick="showHideConfig(this,'detailed_configuration');" id="check_detail_config" name="check_detail_config" type="checkbox" value="1" {DETAILED_CONFIGURATION}/>Show Detailed Configuration...</div>
								</td>
							</tr>
							<tr valign="top" id='detailed_configuration' {SHOW_DETAILED_CONFIGURATION}>
								<td nowrap>
									<div><img src="{SKINROOT}/images/fieldselection.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Field Display Selections</span></div>
									<div id='showFieldSelection'>
									<table width="10" border="0" cellspacing="0" cellpadding="3" class="no-border">
									  <tr class="td">
										<td align="right" nowrap>
											<table class="no-border" cellpadding="4">
											<tr><td align="right" nowrap><a href=#><img title='Move Selection One Step Up' border=0 src="{SKINROOT}/images/up_scroll2.gif" onclick="toup('target');" /></a></td></tr>
											<tr><td align="right" nowrap><a href=#><img title='Move Selection One Step Down' border=0 src="{SKINROOT}/images/down_scroll2.gif" onclick="todown('target');" /></a></td></tr>
											<tr><td align="right" nowrap><a href=#><img title='Move Selection All The Way Up' border=0 src="{SKINROOT}/images/top_scroll.gif" onclick="totop('target');" /></a></td></tr>
											<tr><td align="right" nowrap><a href=#><img title='Move Selection All The Way Down' border=0 src="{SKINROOT}/images/bottom_scroll.gif" onclick="tobottom('target');" /></a></td></tr>
											</table>
										</td>
										<td nowrap class="bold">
											Selected <BR />
											<div id='selectSelected'>
												<select class="textbox" name="target[]" size="10" WIDTH=100 multiple="multiple" id="target">
												{SELECTED_OPTIONS}
												</select>
											</div>
										</td>
										<td nowrap>
											<table class="no-border" cellpadding="4">
											<tr><td align="right" nowrap><a href=#><img title='Move Selection To The Left' border=0 src="{SKINROOT}/images/left_move.gif" onclick="javascript:copyToList('source','target');" /></a></td></tr>
											<tr><td align="right" nowrap><a href=#><img title='Move Selection To The Right' border=0 src="{SKINROOT}/images/right_move.gif" onclick="javascript:copyToList('target','source');" /></a></td></tr>
											</table>
										</td>
										<td nowrap class="bold">
											Available<BR />
											<div id='selectAvailable'>
												<SELECT class="textbox" NAME="source[]" SIZE="10" multiple="multiple" WIDTH=100 id="source" >
												{AVAILABLE_OPTIONS}
												</SELECT>
											</div>
										</td>
									  </tr>
									</table>
									<BR />
									<input name="reset2default" id="reset2default" type="hidden" />
									<input name="targetValue" id="targetValue" type="hidden" />
									<input name="sourceValue" id="sourceValue" type="hidden" />
									<input name="thisIsAJAX" id="thisIsAJAX" type="hidden" value="1"/>
									</div>	
									
								</td>
								<td nowrap>
									<div><img src="{SKINROOT}/images/report_filter.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Report Filters</span></div>
									<div id="search_content">
										<div id='searchListing'>
											<input type="hidden" id='totalFields' name='totalFields' value="{TOTAL_FIELDS}" />
											<input type="hidden" id='filterTotal' name='filterTotal' value="{FILTER_TOTAL}" />
											<input type="hidden" id='reportQuery' name='reportQuery' value="{REPORT_QUERY}"/>
											<input type="hidden" id='filterMap' name='filterMap'/>
											<table id='tableSearch' class="no-border" cellpadding="1" cellspacing="3">
												<tr id="searchMain_1">
													<td><img onclick="deleteField(this.id)" id="deleteImg_1" name="deleteImg_1" style="display:none" src='{SKINROOT}/images/delete.gif' /></td>
													<td>
														<SELECT class='textbox' style="display:none" id='connector_1' name="connector_1" disabled>
															<OPTION value='AND' selected>AND</OPTION> 
															<OPTION value='OR'>OR</OPTION> 
														</SELECT> 		
													</td>
													<td>
														<SELECT class='textbox' style="display:none" id='selectKey_1' name="selectKey_1" onchange='jsQuery(this)'>
															<OPTION title='date' value='StartDate'>Start Date</OPTION>
															<OPTION title='date' value='EndDate'>End Date</OPTION>
															<OPTION title='string' value='ProjectName'>Project Name</OPTION>
															<OPTION title='string' value='ProjectCode'>Project Code</OPTION>
															<OPTION title='number' value='HoursPending'>Hours Pending</OPTION>
															<OPTION title='number' value='HoursApproved'>Hours Approved</OPTION>
															<OPTION title='number' value='HoursRejected'>Hours Rejected</OPTION>
															<OPTION title='number' value='HoursInProgress'>Hours InProgress</OPTION>
															<OPTION title='number' value='OverallHours'>Overall Hours</OPTION>
															<OPTION title='string' value='Status'>Status</OPTION>
														</SELECT> 
													</td>	
													<td>
														<SELECT class='textbox' style="display:none" id='selectKeyQueryOption_1' name="selectKeyQueryOption_1">
															<OPTION value='like'>LIKE</OPTION>
														</SELECT> 
													</td>	
													<td>
														<input class='textbox' style="display:none" type="text" id='selectKeyQueryText_1' name='selectKeyQueryText_1' onkeypress="return onkeypressTrap(this);" />
													</td>	
													<td><img id="calendarField_1" name="calendarField_1" style="display:none" src='{SKINROOT}/images/calendar.gif' /></td>
												</tr>
											</table>
										</div>
										<BR>
										<span>						
											<input class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" type="button" value="Add New Filter" onclick='createField(document.getElementById("searchMain_1"))' />
										</span>
									</div>
								</td>
							</tr>
							</table>
							<div id="listingButtonsAJAX">
								<table class=no-border cellpadding=5 {SHOW_GENERATE}><tr>
									<td><input onclick='ajaxMain(document.forms[0],"generate");' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Generate Report"></td>
								</tr></table>
							</div>
						</fieldset>
					</div>
					<div id="sc2" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/report_result.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Report Results - {H1_TITLE}</span></legend>
						<div id='reportResult'>		
						</div>
						</fieldset>
					</div>
					<div id="sc3" class="tabcontent">
						<p>
						<fieldset><legend><img src="{SKINROOT}/images/report_option.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Save Report - {H1_TITLE}</span></legend>								  
							<div>
								<table class='no-border' cellpadding=5>
									<tr>
										<td>Report Name:</td><td><input id="save_report_name" name="save_report_name" class="textbox" type="text" size="50" maxlength="100" value="{SAVE_REPORT_NAME}" onkeypress="return keyPress(event,'normaltext')"/></td>
									</tr>
									<tr id='report_unsaved_buttons' {REPORT_UNSAVED_BUTTONS}>
										<td colspan=2><input onclick='ajaxMain(document.forms[0],"save_report");' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Save Report"></td>
									</tr>
									<tr id='report_saved_buttons' {REPORT_SAVED_BUTTONS}>
										<td colspan=2>
										<input onclick='ajaxMain(document.forms[0],"update_saved_report");' id="update_saved_report" name="update_saved_report" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Update Saved Report">
										<input onclick="window.location='{REPORT_URL}'" id="create_new_report" name="create_new_report" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Create New Report">
										</td>
									</tr>
								</table>
							</div>
						</fieldset>
						</p>
						<p>
						<fieldset><legend><img src="{SKINROOT}/images/report_option.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Share Report - {H1_TITLE}</span></legend>								  
							<div>
								<table class='no-border' cellpadding=5>
									<tr>
										<td>Report Name:</td><td><input id="share_report_name" name="share_report_name" class="textbox" type="text" size="50" maxlength="100" value="{SHARE_REPORT_NAME}" onkeypress="return keyPress(event,'normaltext')"/></td>
									</tr>
									<tr>
										<td></td><td>
											<table width="10" border="0" cellspacing="0" cellpadding="3" class='no-border'>
											  <tr class="td">
												<td nowrap class="bold">
													Selected <BR />
													<div id='selectSelected'>
														<select class="textbox" name="share_user_target[]" size="5" WIDTH=100 multiple="multiple" id="share_user_target">
														{DROPDOWN_CURRENT_TEAM}
														</select>
													</div>
												</td>
												<td nowrap>
													<table class="no-border" cellpadding="4">
													<tr><td align="right" nowrap><a href=#><img title='Move Selection To The Left' border=0 src="{SKINROOT}/images/left_move.gif" onclick="javascript:copyToList('share_user_source','share_user_target');" /></a></td></tr>
													<tr><td align="right" nowrap><a href=#><img title='Move Selection To The Right' border=0 src="{SKINROOT}/images/right_move.gif" onclick="javascript:copyToList('share_user_target','share_user_source');" /></a></td></tr>
													</table>
												</td>
												<td nowrap class="bold">
													Available<BR />
													<div id='selectAvailable'>
														<SELECT class="textbox" NAME="share_user_source[]" SIZE="5" multiple="multiple" WIDTH=100 id="share_user_source" >
														{DROPDOWN_AVAILABLE_TEAM}
														</SELECT>
													</div>
												</td>
											  </tr>
											</table>										
										</td>
									</tr>
									<tr id='report_unshared_buttons' {REPORT_UNSHARED_BUTTONS}>
										<td colspan=2><input onclick='ajaxMain(document.forms[0],"share_report");' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Share Report"></td>
									</tr>
									<tr id='report_shared_buttons' {REPORT_SHARED_BUTTONS}>
										<td colspan=2>
										<input onclick='ajaxMain(document.forms[0],"update_shared_report");' id="update_shared_report" name="update_shared_report" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Update Shared Report">
										<input onclick="window.location='{REPORT_URL}'" id="create_new_report" name="create_new_report" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Create New Report">
										</td>
									</tr>
									<input name="shareTargetValue" id="shareTargetValue" type="hidden" />
									<input name="shareSourceValue" id="shareSourceValue" type="hidden" />
								</table>
							</div>
						</fieldset>
						</p>
					</div>
					<div id="sc4" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/export.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Export Options - {H1_TITLE}</span></legend>								  
						<div>
							<p>
							<table class='no-border' cellpadding=3>
								<tr>
									<td class='required' nowrap colspan=2>Report Title: <input maxlength="100" name="exportTitle" id="exportTitle" size="50" class="textbox" value="{REPORT_TITLE}" onkeypress="return keyPress(event,'normaltext')"/></td>
								</tr>
								<tr id="exportFileTable" name="exportFileTable" style="display:none">
									<td class='required' nowrap width='10%'>Export Filename:
									<input maxlength="100" name="exportFilename" id="exportFilename" size="30" class="textbox" onkeypress="return keyPress(event,'filename')" />
									<span id='fileExtension' name='fileExtension'></span>
									</td>
								</tr>
							</table>	
							</p>
							<table class='no-border' cellpadding=5>
								<tr>
									<td><input onclick="showFilename(this.id)" id='printer' name="exportOptions" type="radio" value="printer" {PRINTER_CHECKED} /></td>
									<td><img src="{SKINROOT}/images/mime/printer.gif" align="absmiddle" /></td>
									<td>Printer</td>
								</tr>
								<tr>
									<td><input onclick="showFilename(this.id)" id='csv' name="exportOptions" type="radio" value="csv" {CSV_CHECKED} /></td>
									<td><img src="{SKINROOT}/images/mime/csv.gif" align="absmiddle" /></td>
									<td>CSV</td>
								</tr>
								<tr style="display:none">
									<td><input onclick="showFilename(this.id)" id='html' name="exportOptions" type="radio" value="html" {HTML_CHECKED} /></td>
									<td><img src="{SKINROOT}/images/mime/html.jpg" align="absmiddle" /></td>
									<td>HTML</td>
								</tr>
								<tr>
									<td><input onclick="showFilename(this.id)" id='doc' name="exportOptions" type="radio" value="doc" {DOC_CHECKED} /></td>
									<td><img src="{SKINROOT}/images/mime/msword.jpg" align="absmiddle" /></td>
									<td>Microsoft Word</td>
								</tr>
								<tr>
									<td><input onclick="showFilename(this.id)" id='xls' name="exportOptions" type="radio" value="xls" {XLS_CHECKED} /></td>
									<td><img src="{SKINROOT}/images/mime/msexcel.gif" align="absmiddle" /></td>
									<td>Microsoft Excel</td>
								</tr>
								<tr>
									<td colspan="3"><BR /><input onclick="ajaxMain(document.forms[0],'export_report')" id="exportButton" name="exportButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Export Report"/></td>
								</tr>
							</table>						
						</div>
						</fieldset>
					</div>

					<div id="sc5" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/email_write.gif" align="absmiddle" />&nbsp;<span id='subtitle'>Email Report - {H1_TITLE}</span></legend>								  
						<div>
							<table nowrap cellspacing="0" cellpadding="4">
								<th align="left" colspan="4">Details</th>
								<tr>
									<td id="field_required">From:</td>
									<td id="From"><input title='required' value="{FROM}" class="textbox" id="sender_name" name="sender_name" type="text" size="30" maxlength="250" onKeyPress="return keyPress(event,'normaltext')"></td>
								</tr>
								<tr>
									<td id="field_required">Sender Address:</td>
									<td id="Sender Address"><input title='required' value="{SENDER}" class="textbox" id="sender_email" name="sender_email" type="text" size="30" maxlength="250" onkeypress="return keyPress(event,'email')"></td>
								</tr>
								<tr>
									<td id="field_required">Recipients:</td>
									<td colspan="3">
										<table width="10" border="0" cellspacing="0" cellpadding="3" class='no-border'>
											<tr class="td">
												<td nowrap class="bold">
													Selected <BR />
													<div id='selectSelected'>
														<select class="textbox" name="email_target[]" size="5" WIDTH=100 multiple="multiple" id="email_target"></select>
													</div>
												</td>
												<td nowrap>
													<table class="no-border" cellpadding="4">
														<tr><td align="right" nowrap><a href=#><img title='Move Selection To The Left' border=0 src="{SKINROOT}/images/left_move.gif" onclick="javascript:copyToList('email_source','email_target');" /></a></td></tr>
														<tr><td align="right" nowrap><a href=#><img title='Move Selection To The Right' border=0 src="{SKINROOT}/images/right_move.gif" onclick="javascript:copyToList('email_target','email_source');" /></a></td></tr>
													</table>
												</td>
												<td nowrap class="bold">
													Available<BR />
													<div id='selectAvailable'>
														<SELECT class="textbox" NAME="email_source[]" SIZE="5" multiple="multiple" WIDTH=100 id="email_source" >{RECEPIENTS}</SELECT>
													</div>
												</td>
											</tr>
										</table>							
									</td>
								</tr>
								<tr>
									<td>Limit Email Messages:</td>
									<td colspan="3">
										<SELECT class="textbox" id="mail_limit" name="mail_limit">
											<OPTION value="5">5</OPTION>
											<OPTION value="10">10</OPTION>
											<OPTION value="15">15</OPTION>
											<OPTION value="20">20</OPTION>
											<OPTION value="30">30</OPTION>
											<OPTION value="40">40</OPTION>
											<OPTION value="50">50</OPTION>
										</SELECT>&nbsp;recipients/message (lower for slower server)
									</td>
								</tr>
								<tr>
									<td id="field_required">Subject:</td>
									<td id="Subject"><input title='required' class="textbox" id="email_subject" name="email_subject" type="text" size="64" maxlength="250" value="{SUBJECT}" onkeypress="return keyPress(event,'normaltext')"></td>
								</tr>
								<tr>
									<td id="field_required">Content:</td>
									<td id="Content"><textarea title='required' class="textbox" id="email_content" name="email_content" cols="60" rows="6" onkeypress="return keyPress(event,'textarea')">{REPORT_RESULT}</textarea></td>
								</tr>
								<tr>
									<td id="Content"></td>
									<td id="norecord">{REPORT RESULT} will be replaced by Actual Result in Email</td>
								</tr>
							</table>
							<input name="emailTargetValue" id="emailTargetValue" type="hidden" />
							<input name="emailSourceValue" id="emailSourceValue" type="hidden" />
						</div>
							<div id="listingButtonsAJAX"><input onclick="ajaxMain(document.forms[0],'email_report')" id="emailButton" name="emailButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Email Report"/></div>
						</fieldset>
					</div>					
					<div id="logsection" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/log.gif" align="absmiddle" /><span id='logtitle'>No Log Data In Session</span></legend>											
						<div id="logdata">
							<BR />
							<input onclick='getLog()' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Refresh Log Data">
						</div>
						</fieldset>	
					</div>
					<div id="helpsection" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/help.gif" align="absmiddle" /><span id='helptitle'>No Context Help Data In Session</span></legend>											
						<div id="helpdata">
							<BR />
							<input onclick='getHelp()' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Refresh Context Help">
						</div>
						</fieldset>	
					</div>
					</form>
				</DIV>		
			</td></tr>
		</table>
		{SHOW_FOOTER}
		</td> 
	</tr>
	</table>
</td></tr></table>
		<script type="text/javascript">
			Calendar.setup(
				{
					inputField 	: 	"start_date",
					ifFormat	:	"{DATE_FORMAT}",
					button		:	"start_date_icon"	
				}
			);
			Calendar.setup(
				{
					inputField 	: 	"end_date",
					ifFormat	:	"{DATE_FORMAT}",
					button		:	"end_date_icon"	
				}
			);
		</script>

<script>var oriMessage = document.getElementById('title').innerHTML;</script>
{HIDE_SHOW_DETAILED}
{SCRIPT_SAVED_FILTER}
</body>
</html>
