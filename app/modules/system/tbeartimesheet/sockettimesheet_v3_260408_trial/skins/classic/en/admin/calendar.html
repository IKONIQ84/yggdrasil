<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>{PAGE_TITLE}</title>
{__CSS_GLOBAL__}
<style type="text/css">@import url('{SKINROOT}/javascript/{BROWSER}/calendar/calendar-blue.css');</style>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar-en.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/calendar/calendar-setup.js"></script>

<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/helpScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/tabScript.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/functions.js"></script>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/ajaxScript.js"></script>
<script>
// AJAX CORNER

function ajaxParser(){
	if(request.readyState == 1){
		document.getElementById('title').innerHTML = oriMessage + '&nbsp;&nbsp;&nbsp;<font id="executing"><img align="top" src="{SKINROOT}/images/executing.gif">Executing...</font>';
	}
	if(request.readyState == 4){ 
		var result = request.responseText.split('regexAJAX');
		document.getElementById('title').innerHTML = oriMessage;

		//INITIALIZE ALL RELATED FIELDS
		document.getElementById('add_event').style.display='none';
		document.getElementById('update_event').style.display='none';
		document.getElementById('daily_event').style.display='none';		

		document.getElementById('start_dateUpdate').value = '';
		document.getElementById('end_dateUpdate').value = '';
		document.getElementById('headlineUpdate').value = '';
		document.getElementById('descriptionUpdate').value = '';
		document.getElementById('start_dateAdd').value = '';
		document.getElementById('end_dateAdd').value = '';
		document.getElementById('headlineAdd').value = '';
		document.getElementById('descriptionAdd').value = '';
		document.getElementById('announcementAdd').checked = false;

		if(document.getElementById('action').value == 'add_event') {
			//PUT DUMMY VALUE IN UPDATE REQUIRED FIELDS
			document.getElementById('start_dateUpdate').value = '2007-01-01';
			document.getElementById('end_dateUpdate').value = '2007-01-01';
			document.getElementById('headlineUpdate').value = 'Testing';
			
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('start_dateAdd').value = result[1];
			document.getElementById('end_dateAdd').value = result[1];
			document.getElementById('add_event').style.display='';
			document.getElementById('submit_action').value='add';			
			expandcontent('sc2', document.getElementById('add_event'));
		}	
		if(document.getElementById('action').value == 'update_event') {
			document.getElementById('start_dateAdd').value = '2007-01-01';
			document.getElementById('end_dateAdd').value = '2007-01-01';
			document.getElementById('headlineAdd').value = 'Testing';

			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('start_dateUpdate').value = result[1];
			document.getElementById('end_dateUpdate').value = result[2];
			document.getElementById('headlineUpdate').value = result[3];
			document.getElementById('descriptionUpdate').value = result[4];
			document.getElementById('categoryUpdate').innerHTML = result[5];
			document.getElementById('announcementUpdate').checked = result[6];
			document.getElementById('enableUpdate').checked = result[7];
			document.getElementById('update_event').style.display='';
			document.getElementById('submit_action').value='update';			
			expandcontent('sc3', document.getElementById('update_event'));
		}	
		if(document.getElementById('action').value == 'add' || document.getElementById('action').value == 'update') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('calendarTableAJAX').innerHTML = result[1];
			expandcontent('sc1', document.getElementById('calendarTable'));
		}	
		if(document.getElementById('action').value == 'gotoCalendar' || document.getElementById('action').value == 'gotoLastMonth' || document.getElementById('action').value == 'gotoNextMonth') {
			document.getElementById('calendarTableAJAX').innerHTML = result[0];
			document.getElementById('currentMonth').value = result[1];
			document.getElementById('currentYear').value = result[2];
		}	
		if(document.getElementById('action').value == 'delete_event') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('calendarTableAJAX').innerHTML = result[1];
		}	
		if(document.getElementById('action').value == 'daily_event') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('daily_event').style.display='';
			expandcontent('sc4', document.getElementById('daily_event'));
		}	

		if(document.getElementById('action').value == 'delete_quicklinks' || document.getElementById('action').value == 'add_quicklinks') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('quicklinks_button').innerHTML = result[1];
			document.getElementById('menuAJAX').innerHTML = result[2];
		}
		if(document.getElementById('action').value == 'gethelp') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('helptitle').innerHTML = "Context Help";
			document.getElementById('helpdata').innerHTML = result[1];
			if(!document.getElementById('nohelp'))
				document.getElementById('helpdetected').value = 1;			
		}
		if(document.getElementById('action').value == 'getlog') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('logtitle').innerHTML = "Log Data";
			document.getElementById('logdata').innerHTML = result[1];
		}
		if(document.getElementById('action').value == 'startpage') {
			document.getElementById(document.getElementById('messageID').value).innerHTML = result[0];
			document.getElementById('DefaultPage').innerHTML = result[1];
		}
		//CLEAR THE RELEVANT TEXTBOXES AFTER AJAX
		document.getElementById('action').value = '';
		enableButtons(document.forms[0]);
	}
	formParams = '';
}

function ajaxMain(formName,action){
	if(action == 'add') {
		if(!checkStartEndDate('start_dateAdd','end_dateAdd'))
			return false;
	}
	if(action == 'update') {
		if(!checkStartEndDate('start_dateUpdate','end_dateUpdate'))
			return false;
	}
	if(action == 'delete_event') {
		if(!confirm('Are You Sure?')) {
			return false;
		}	
	}	
	document.getElementById('action').value = action;
	getFormFields(formName);
	if(formParams == '') {
		for (i=0; i<formName.elements.length; i++) {
			if(formName.elements[i].id) {
				if(formName.elements[i].type == 'checkbox' || formName.elements[i].type == 'radio') {
					 if(formName.elements[i].checked) {
						formParams = formParams + "&" + formName.elements[i].id + "=" + encodeURIComponent(formName.elements[i].value);
					}	
				}
				else {
					formParams = formParams + "&" + formName.elements[i].id + "=" + encodeURIComponent(formName.elements[i].value);
				}	
			}	
			else if(formName.elements[i].name) {
				if(formName.elements[i].type == 'checkbox' || formName.elements[i].type == 'radio') {
					 if(formName.elements[i].checked) {
						formParams = formParams + "&" + formName.elements[i].name + "=" + encodeURIComponent(formName.elements[i].value);
					}	
				}
				else {	
					formParams = formParams + "&" + formName.elements[i].name + "=" + encodeURIComponent(formName.elements[i].value);
				}	
			}	
		}
	}

	request.open('POST', '{AJAX_FORM_POST}', true); //THIS ONE FOR POST
	request.onreadystatechange = ajaxParser;
	request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); //THIS ONE ADDED FOR POST ONLY
	request.send(formParams); //THIS ONE FOR POST
}
// AJAX CORNER
function addEvent(currentDate) {
	document.getElementById('addEventDate').value = currentDate;
	ajaxMain(document.forms[0],"add_event");
}
function deleteEvent(ID) {
	document.getElementById('deleteEventID').value = ID;
	ajaxMain(document.forms[0],"delete_event");
}
function updateEvent(ID) {
	document.getElementById('updateEventID').value = ID;
	ajaxMain(document.forms[0],"update_event");
}
function dailyEvent(currentDate) {
	document.getElementById('dailyEventDate').value = currentDate;
	ajaxMain(document.forms[0],"daily_event");
}
</script>

</head>

<body onload="showTab();">
<div id="dhtmltooltip"></div>
<script type="text/javascript" src="{SKINROOT}/javascript/{BROWSER}/tooltip.js"></script>
<table width="100%" cellpadding="0" cellspacing="2">
	<tr>
		<td><img src="{SKINROOT}/images/logo.gif" /></td>
		<td height="100%" valign="bottom">
			<table align="right" height="100%" cellspacing="5" cellpadding="0">
			<tr>
				<td class="td_top">Logged In: {FULL_NAME} |</td>
				<td class="td_top">{ADMIN_USER_LINK}</td>
				<td class="td_top">{LOGOUT_LINK}</td>
			</tr></table>
		</td>
	</tr>
	<tr><td class="spacer" colspan="2"></td></tr>
</table>
	
<div class="div_top_menu">
	{DIV_TOP_MENU}
</div>
	
<div class="div_top_menu_foot"></div>
<div id='submenu' class="div_sub_menu" align="right">Clock & Date Container</div>
<script>startclock();</script>

<table width="100%" height="100%"><tr><td nowrap valign="top">
	<table width="100%" height="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td class="menu_table_parent">
		<table class="menu_table_container">
		<tr><td>
			{SIDE_MENU}
		</td></tr>
		<tr><td>
			<div id="menuAJAX" name="menuAJAX">
				{QUICKLINKS_MENU}
			</div>
		</td></tr>
		</table>
		</td>
		<td class="main_table">
		<table width="100%" class="module_page_table">
			<tr><td>
				<H1 id='title' name='title'>{H1_TITLE}</H1>
				<div id="div_breadcrumbs" name="div_breadcrumbs">{BREADCRUMBS}</div>
				<div id="{MESSAGE_ID}" name="{MESSAGE_ID}" {MESSAGE_BOX}>{MESSAGE}</div>
			</td></tr>
			<tr><td height="10"></td></tr>
			<tr><td nowrap>
				<ul id="tablist" style="display:none">
					<li><span name='calendarTable' id='calendarTable' class="current" onmouseover="overtab('sc1',this)" onmouseout="outtab('sc1',this)" onclick="return expandcontent('sc1', this)"><img title='tabimage' src="{SKINROOT}/images/calendar.gif" align="absmiddle" />&nbsp;Calendar Configuration</span></li>
					<li><span style="display:none" name='add_event' id='add_event' class="current" onmouseover="overtab('sc2',this)" onmouseout="outtab('sc2',this)" onclick="return expandcontent('sc2', this)"><img title='tabimage' src="{SKINROOT}/images/add_event.gif" align="absmiddle" />&nbsp;Add Event</span></li>
					<li><span style="display:none" name='update_event' id='update_event' class="current" onmouseover="overtab('sc3',this)" onmouseout="outtab('sc3',this)" onclick="return expandcontent('sc3', this)"><img title='tabimage' src="{SKINROOT}/images/update_event.gif" align="absmiddle" />&nbsp;Update Event</span></li>
					<li><span style="display:none" name='daily_event' id='daily_event' class="current" onmouseover="overtab('sc4',this)" onmouseout="outtab('sc4',this)" onclick="return expandcontent('sc4', this)"><img title='tabimage' src="{SKINROOT}/images/list_events.gif" align="absmiddle" />&nbsp;Daily View</span></li>
					<li><span onmouseover="overtab('logsection',this)" onmouseout="outtab('logsection',this)" onclick="getLog();return expandcontent('logsection', this)"><img title='tabimage' src="{SKINROOT}/images/log.gif" align="absmiddle" />&nbsp;Log</span></li>
					<li><span onmouseover="overtab('helpsection',this)" onmouseout="outtab('helpsection',this)" onclick="getHelp();return expandcontent('helpsection', this)"><img title='tabimage' src="{SKINROOT}/images/help.gif" align="absmiddle" />&nbsp;Help</span></li>
				</ul>
	
				<DIV id="tabcontentcontainer">
					<form name='addupdate' id='addupdate' {FORM_ACTION} method="post" onsubmit="submitonce(this)">
					<input name="addupdateID" id="addupdateID" type="hidden" value="{ID}" />
					<input name="update_title" id="update_title" type="hidden" value="{UPDATE_TITLE}" />
					<input name="action" id="action" type="hidden" />
					<input name="submit_action" id="submit_action" type="hidden" value="{SUBMIT_ACTION}" />
					<input name="messageID" id="messageID" value="{MESSAGE_ID}" type="hidden" />
					<input name="quickLinksName" id="quickLinksName" type="hidden" value="{QUICKLINKS_NAME}"/>
					<input name="quickLinksURL" id="quickLinksURL" type="hidden" value="{QUICKLINKS_URL}"/>
					<input name="quickLinksDesc" id="quickLinksDesc" type="hidden" value="{QUICKLINKS_DESC}"/>
					<input name="helpdetected" id="helpdetected" type="hidden"/>
					<input name="LogType" id="LogType" type="hidden" value="{LOGTYPE}"/>
					<input name="LogAction" id="LogAction" type="hidden" value="{LOGACTION}"/>
					<input name="startup_page" id="startup_page" type="hidden" value="{STARTUP_PAGE}"/>
					<!-- CALENDAR SPECIFIC -->
					<input name="addEventDate" id="addEventDate" type="hidden" />
					<input name="updateEventDate" id="updateEventDate" type="hidden" />
					<input name="updateEventID" id="updateEventID" type="hidden" />
					<input name="dailyEventDate" id="dailyEventDate" type="hidden" />
					<input name="deleteEventID" id="deleteEventID" type="hidden" />
					<input name="gotoDate" id="gotoDate" type="hidden" />
					<input name="currentMonth" id="currentMonth" type="hidden" value="{CURRENT_MONTH}"/>
					<input name="currentYear" id="currentYear" type="hidden" value="{CURRENT_YEAR}" />
					
					<div id="sc1" class="tabcontent">
						<fieldset>
							<legend><img src="{SKINROOT}/images/calendar.gif" align="absmiddle" />&nbsp;
								<span id='subtitle'>Calendar Configuration</span>
								<span id='subtitle'><img onclick="ajaxMain(document.forms[0],'gotoCalendar');" src="{SKINROOT}/images/calendar_jump.gif" align="absmiddle" /> <SELECT class="textbox" id="months" name="months">{CALENDAR_MONTHS}</SELECT> <SELECT class="textbox" id="years" name="years">{CALENDAR_YEARS}</SELECT></span>
							</legend>
							<div id="calendarTableAJAX">
								{CALENDAR_TABLE}
							</div>
						</fieldset>
					</div>
					<div id="sc2" class="tabcontent">
						<fieldset>
							<legend><img src="{SKINROOT}/images/add_event.gif" align="absmiddle" />&nbsp;
								<span id='subtitle'>Add Event</span>
							</legend>
							<div id="listingOutputAJAX">
								<table nowrap cellspacing="0" cellpadding="3">
									<tr><th colspan=3>Add Event Details</th></tr>
									</tr>
									<tr>
									  <td id="field_required">Headline:</td><td></td>
									  <td id="Headline"><input onkeypress="return keyPress(event,'normaltext');" title='required' class="textbox" id="headlineAdd" name="headlineAdd" type="text" size="50" maxlength="250"></td>
									</tr>
									<tr>
									  <td>Description:</td><td></td>
									  <td><textarea onkeypress="return keyPress(event,'normaltext');" class="textbox" id="descriptionAdd" name="descriptionAdd" cols="50" rows="5"></textarea></td>
									</tr>
									<tr>
									  <td id="field_required">Start Date:</td><td></td>
									  <td id="Start Date"><input title='required' class="textbox" id="start_dateAdd" name="start_dateAdd" type="text" size="14" readonly>&nbsp;<img align="absmiddle" id="start_dateAddIcon" name="start_dateAddIcon" src="{SKINROOT}/images/calendar.gif"></td>
									</tr>
									<tr>
									  <td id="field_required">End Date:</td><td></td>
									  <td id="End Date"><input title='required' class="textbox" id="end_dateAdd" name="end_dateAdd" type="text" size="14" readonly>&nbsp;<img align="absmiddle" id="end_dateAddIcon" name="end_dateAddIcon" src="{SKINROOT}/images/calendar.gif"></td>
									</tr>
									<tr>
									  <td>Category:</td><td></td>
									  <td><SELECT id="categoryAdd" name="categoryAdd" class="textbox">{CATEGORY_ADD}</SELECT></td>
									</tr>
									<tr>
									  <td>Share With Announcement:</td><td></td>
									  <td><input type="checkbox" value="1" id="announcementAdd" name="announcementAdd" /></td>
									</tr>
									<tr>
									  <td>Enable Event:</td><td></td>
									  <td><input type="checkbox" value="1" id="enableAdd" name="enableAdd" CHECKED /></td>
									</tr>
								</table>
							</div>
							<div id="listingButtonsAJAX">{SHOW_ADD_BUTTON}</div>
						</fieldset>
					</div>
					<div id="sc3" class="tabcontent">
						<fieldset>
							<legend><img src="{SKINROOT}/images/update_event.gif" align="absmiddle" />&nbsp;
								<span id='subtitle'>Update Event</span>
							</legend>
							<div id="listingUpdateAJAX">
								<table nowrap cellspacing="0" cellpadding="3">
									<tr><th colspan=3>Update Event Details</th></tr>
									<tr>
									  <td id="field_required">Headline:</td><td></td>
									  <td id="Headline"><input onkeypress="return keyPress(event,'normaltext');" title='required' class="textbox" id="headlineUpdate" name="headlineUpdate" type="text" size="50" maxlength="250"></td>
									</tr>
									<tr>
									  <td>Description:</td><td></td>
									  <td><textarea onkeypress="return keyPress(event,'normaltext');" class="textbox" id="descriptionUpdate" name="descriptionUpdate" cols="50" rows="5"></textarea></td>
									</tr>
									<tr>
									  <td id="field_required">Start Date:</td><td></td>
									  <td id="Start Date Update"><input title='required' class="textbox" id="start_dateUpdate" name="start_dateUpdate" type="text" size="14" readonly>&nbsp;<img align="absmiddle" id="start_dateUpdateIcon" name="start_dateUpdateIcon" src="{SKINROOT}/images/calendar.gif"></td>
									</tr>
									<tr>
									  <td id="field_required">End Date:</td><td></td>
									  <td id="End Date Update"><input title='required' class="textbox" id="end_dateUpdate" name="end_dateUpdate" type="text" size="14" readonly>&nbsp;<img align="absmiddle" id="end_dateUpdateIcon" name="end_dateUpdateIcon" src="{SKINROOT}/images/calendar.gif"></td>
									</tr>
									<tr>
									  <td>Category:</td><td></td>
									  <td id='categoryUpdate'></td>
									</tr>
									<tr>
									  <td>Share With Announcement:</td><td></td>
									  <td><input type="checkbox" value="1" id="announcementUpdate" name="announcementUpdate" /></td>
									</tr>
									<tr>
									  <td>Enable Event:</td><td></td>
									  <td><input type="checkbox" value="1" id="enableUpdate" name="enableUpdate" CHECKED /></td>
									</tr>
								</table>
							</div>
							<div id="listingButtonsAJAX">{SHOW_UPDATE_BUTTON}</div>
						</fieldset>
					</div>
					<div id="sc4" class="tabcontent">
						<fieldset>
							<legend><img src="{SKINROOT}/images/list_events.gif" align="absmiddle" />&nbsp;
								<span id='subtitle'>Daily View</span>
							</legend>
						</fieldset>
					</div>
					<div id="logsection" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/log.gif" align="absmiddle" /><span id='logtitle'>No Log Data In Session</span></legend>											
						<div id="logdata">
							<BR />
							<input onclick='getLog()' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Refresh Log Data">
						</div>
						</fieldset>	
					</div>
					<div id="helpsection" class="tabcontent">
						<fieldset><legend><img src="{SKINROOT}/images/help.gif" align="absmiddle" /><span id='helptitle'>No Context Help Data In Session</span></legend>											
						<div id="helpdata">
							<BR />
							<input onclick='getHelp()' id="submitButton" name="submitButton" type="button" class="buttons" onmouseover="this.className='buttons_over'" onmouseout="this.className='buttons'" value="Refresh Context Help">
						</div>
						</fieldset>	
					</div>
					</form>
				</DIV>		
			</td></tr>
		</table>
		{SHOW_FOOTER}
		</td> 
	</tr>
	</table>
</td></tr></table>
<script>var oriMessage = document.getElementById('title').innerHTML;</script>
<script type="text/javascript">
	Calendar.setup(
		{
			inputField 	: 	"start_dateAdd",
			ifFormat	:	"{DATE_FORMAT}",
			button		:	"start_dateAddIcon"	
		}
	);
	Calendar.setup(
		{
			inputField 	: 	"end_dateAdd",
			ifFormat	:	"{DATE_FORMAT}",
			button		:	"end_dateAddIcon"	
		}
	);
	Calendar.setup(
		{
			inputField 	: 	"start_dateUpdate",
			ifFormat	:	"{DATE_FORMAT}",
			button		:	"start_dateUpdateIcon"	
		}
	);
	Calendar.setup(
		{
			inputField 	: 	"end_dateUpdate",
			ifFormat	:	"{DATE_FORMAT}",
			button		:	"end_dateUpdateIcon"	
		}
	);
</script>
</body>
</html>
